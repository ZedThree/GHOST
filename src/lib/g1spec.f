      SUBROUTINE G1SPEC(ICHAR,IFONT,IXPTS,IYPTS,LENGTH)
C
C          ------------------------------------------------
C          ROUTINE NO. (1033)   VERSION (A8.2)    03:JAN:90
C          ------------------------------------------------
C
C          THIS PROVIDES THE VECTOR-STRING SPECIFICATION
C          FOR DRAWING ANY REQUIRED GHOST SOFTWARE CHARACTER.
C
C
C          THE INPUT ARGUMENTS ARE AS FOLLOWS:
C
C          <ICHAR>  IS THE NO. OF THE REQUIRED CHARACTER,
C          <IFONT>  IS THE NO. OF THE REQUIRED FONT (0-3).
C
C          THE OUTPUT ARGUMENTS ARE AS FOLLOWS:
C
C          [IXPTS]  ARE THE VECTOR X-COORDINATES AND
C          [IYPTS]  ARE THE VECTOR Y-COORDINATES, WHILE
C          <LENGTH> IS THE NO. OF VECTORS IN THE STRING.
C
C
C          THE CHAR. SPECIFICATIONS ARE HELD IN [ISPECS]
C          AND THE INDEX POINTERS FOR UNIQUE AND COMMON
C          CHARS. IN [INDEXS] AND [INDEXC] RESPECTIVELY.
C
      INTEGER IXPTS(30),IYPTS(30),INDEXS(2,3,128),
     &        INDEXC(2,96),ISPECS(2466),LFON1A(133),
     &        LFON1B(168),LFON1C(129),LFON1D(125),LFON1E(131),
     &        LFON1F(153),LFON1G(30),LMATHA(143),LMATHB(130),
     &        LMATHC( 88),LMARKA(176),LMARKB(104),LFON2A(173),
     &        LFON2B(126),LFON2C(12),LFON3A(209),LFON3B(190),
     &        LFON3C(207),LFON3D(39),NDXC1(96),NDXC2(96),
     &        NDXS1(96),NDXS2(96),NDXS3(96),NDXS4(96),
     &        NDXS5(96),NDXS6(96),NDXS7(96),NDXS8(96)
C
      COMMON /T1CDEF/ KSTRT,NDEFS,KNUM(30),KPOSN(30),KLEN(30),KSPEC(500)
C
      EQUIVALENCE (ISPECS(   1),LFON1A(1)), (ISPECS( 134),LFON1B(1)),
     &            (ISPECS( 302),LFON1C(1)), (ISPECS( 431),LFON1D(1)),
     &            (ISPECS( 556),LFON1E(1)), (ISPECS( 687),LFON1F(1)),
     &            (ISPECS( 840),LFON1G(1)), (ISPECS( 870),LMATHA(1)),
     &            (ISPECS(1013),LMATHB(1)), (ISPECS(1143),LMATHC(1)),
     &            (ISPECS(1231),LMARKA(1)), (ISPECS(1407),LMARKB(1)),
     &            (ISPECS(1511),LFON2A(1)), (ISPECS(1684),LFON2B(1)),
     &            (ISPECS(1810),LFON2C(1)), (ISPECS(1822),LFON3A(1)),
     &            (ISPECS(2031),LFON3B(1)), (ISPECS(2221),LFON3C(1)),
     &            (ISPECS(2428),LFON3D(1)),
     &            (INDEXS(1,1,  1),NDXS1(1)),(INDEXS(1,1, 17),NDXS2(1)),
     &            (INDEXS(1,1, 33),NDXS3(1)),(INDEXS(1,1, 49),NDXS4(1)),
     &            (INDEXS(1,1, 65),NDXS5(1)),(INDEXS(1,1, 81),NDXS6(1)),
     &            (INDEXS(1,1, 97),NDXS7(1)),(INDEXS(1,1,113),NDXS8(1)),
     &            (INDEXC(1, 1),NDXC1(1)), (INDEXC(1,49),NDXC2(1))
C
      SAVE ISPECS,LFON1A,LFON1B,LFON1C,LFON1D,LFON1E,LFON1F,LFON1G,
     &     LMATHA,LMATHB,LMATHC,LMARKA,LMARKB,LFON2A,LFON2B,LFON2C,
     &     LFON3A,LFON3B,LFON3C,LFON3D
      SAVE INDEXS,NDXS1,NDXS2,NDXS3,NDXS4,NDXS5,NDXS6,NDXS7,NDXS8
      SAVE INDEXC,NDXC1,NDXC2
C
C          DATA INITIALISATION OF CHARACTER SPECIFICATIONS:
C
C          THE FOLLOWING SPECIFY THE STANDARD PART OF FONT-1:
C
      DATA LFON1A /31,30,20,21,31,70,32,37,27,22,32,
     &             25,27,70,37,35,
     &             20,36,70,46,30,70,42,22,70,24,44,
     &             20,37,70,47,30,70,12,21,41,52,53,14,15,26,46,55,
     &             37,35,15,17,57,10,32,52,50,30,32,
     &             50,15,16,27,37,46,45,12,11,20,30,51,
     &             35,57,
     &             50,42,45,57,
     &             10,22,25,17,
     &             30,34,70,53,11,70,13,51,
     &             30,34,70,12,52,
     &             72,23,33,20,10,23,
     &             12,52,
     &             20,21,31,30,20,
     &             10,57,
     &             20,12,15,27,47,55,52,40,20,
     &             26,37,30,
     &             16,27,47,56,54,11,10,50,
     &             17,57,24,44,53,51,40,20,11/
      DATA LFON1B /37,12,52,70,44,40,
     &             10,40,51,53,44,14,17,57,
     &             13,24,44,53,51,40,20,11,13,47,
     &             17,57,56,34,22,20,
     &             24,15,16,27,47,56,55,44,53,51,40,20,11,13,24,44,
     &             20,54,56,47,27,16,14,23,43,54,
     &             21,31,30,20,21,70,22,23,33,32,22,
     &             72,23,33,20,10,23,70,24,25,35,34,24,
     &             50,12,54,
     &             11,51,70,13,53,
     &             10,52,14,
     &             16,27,47,56,55,23,22,32,70,31,30,20,21,31,
     &             42,31,22,23,34,44,41,52,54,45,25,14,11,20,40,51,
     &             10,23,37,43,70,23,43,50,
     &             14,17,47,56,55,44,53,51,40,10,14,44,
     &             51,40,20,11,16,27,47,56,
     &             10,17,47,56,51,40,10,
     &             50,10,17,57,70,14,44,
     &             10,17,57,70,14,44/
      DATA LFON1C /43,53,50,20,11,16,27,47,56,
     &             17,10,70,14,54,70,57,50,
     &             20,40,70,30,37,70,27,47,
     &             12,11,20,40,51,57,
     &             10,17,70,57,14,50,
     &             17,10,50,
     &             10,17,34,57,50,
     &             10,17,50,57,
     &             11,16,27,47,56,51,40,20,11,
     &             10,17,47,56,54,43,13,
     &             11,16,27,47,56,51,40,20,11,70,32,50,
     &             10,17,47,56,54,43,13,70,33,50,
     &             11,20,40,51,53,44,24,15,16,27,47,56,
     &             30,37,70,17,57,
     &             17,11,20,40,51,57,
     &             17,30,57,
     &             17,20,33,40,57,
     &             10,57,70,17,50,
     &             30,34,70,17,34,57/
      DATA LFON1D /17,57,10,50,
     &             50,30,37,57,
     &             17,50,
     &             10,30,37,17,
     &             15,37,55,
     &             73,10,50,
     &             17,35,
     &             13,24,44,53,50,70,51,40,20,11,22,52,
     &             13,24,44,53,51,40,20,11,70,10,17,
     &             51,40,20,11,13,24,44,53,
     &             53,44,24,13,11,20,40,51,70,50,57,
     &             12,52,53,44,24,13,11,20,40,51,
     &             30,36,47,57,70,24,54,
     &             71,11,20,40,51,57,70,56,47,27,16,14,23,43,54,
     &             10,17,70,13,24,44,53,50,
     &             30,34,70,35,
     &             73,10,20,31,35,70,36,
     &             20,27,70,54,22,50,
     &             37,31,40,50/
      DATA LFON1E /10,14,70,13,24,33,30,70,33,44,53,50,
     &             10,14,70,13,24,44,53,50,
     &             11,13,24,44,53,51,40,20,11,
     &             71,10,17,70,16,27,47,56,54,43,23,14,
     &             71,50,57,70,56,47,27,16,14,23,43,54,
     &             10,14,70,13,24,44,53,
     &             11,20,40,51,42,22,13,24,44,53,
     &             14,44,70,25,21,30,41,
     &             14,11,20,40,51,70,50,54,
     &             14,30,54,
     &             14,20,32,40,54,
     &             10,54,70,14,50,
     &             71,10,33,70,17,33,57,
     &             14,54,10,50,
     &             57,46,44,33,42,40,73,50,
     &             31,36,
     &             17,26,24,33,22,20,73,10,
     &             16,27,46,57/
C
C          THE FOLLOWING SPECIFY THE EXTENDED PART OF FONT-1:
C
      DATA LFON1F /11,16,27,47,56,51,40,20,11,70,10,57,
     &             11,13,24,44,53,51,40,20,11,70,10,54,
     &             10,24,44,70,24,37,70,57,37,30,50,
     &             13,24,33,70,30,31,20,11,22,52,53,44,33,31,40,51,
     &             10,17,70,15,26,46,55,52,41,21,12,
     &             71,10,74,17,70,13,24,44,53,51,40,20,11,
     &             50,10,70,20,26,37,47,56,70,13,43,
     &             10,16,27,47,56,55,44,14,70,44,53,51,40,20,
     &             76,25,26,36,35,25,
     &             76,17,36,57,
     &             76,16,56,
     &             76,26,16,17,27,26,70,36,37,47,46,36,
     &             76,36,57,
     &             76,16,37,56,
     &             76,26,27,70,37,36,
     &             76,16,27,46,57,
     &             25,26,36,35,25,
     &             16,35,56,
     &             15,55/
      DATA LFON1G /25,15,16,26,25,70,35,36,46,45,35,
     &             76,17,36,
     &             72,30,40,41,31,32,
     &             14,27,37,24,14,
     &             44,37,47,54,44/
C
C          THE FOLLOWING SPECIFY THE MATHEMATICAL SYMBOLS:
C
      DATA LMATHA /10,50,70,30,34,70,12,52,
     &             11,51,70,52,12,70,13,53,
     &             12,23,42,53,
     &             12,51,70,52,13,54,
     &             30,12,34,70,54,32,50,
     &             30,12,34,70,12,52,
     &             30,34,70,12,34,52,
     &             21,22,32,31,21,
     &             21,20,10,11,21,70,22,23,33,32,22,70,31,41,40,30,31,
     &             12,13,23,22,12,70,21,31,30,20,21,70,32,33,43,42,32,
     &             15,27,
     &             31,70,33,70,12,52,
     &             30,34,70,54,14,70,12,52,
     &             20,44,70,53,13,70,11,51,
     &             11,13,24,40,51,53,44,20,11,
     &             51,11,70,12,23,42,53,
     &             14,53,12,70,11,52,
     &             10,32,14,70,34,52,30,
     &             30,52,34,70,12,52/
      DATA LMATHB /30,34,70,12,30,52,
     &             26,27,37,36,26,
     &             21,20,10,11,21,70,22,12,13,23,22,70,32,33,43,42,32,
     &                                              70,31,41,40,30,31,
     &             15,27,70,37,25,
     &             30,34,
     &             10,50,70,30,34,
     &             72,11,20,31,76,36,47,56,
     &             11,22,30,75,47,57,
     &             10,50,57,17,70,24,54,
     &             51,50,10,44,17,57,56,
     &             12,42,70,51,40,20,11,13,24,44,53,
     &             10,34,50,
     &             10,14,54,50,10,
     &             21,51,70,53,23,70,34,12,30,
     &             50,20,11,13,24,54,
     &             10,13,24,44,53,50,
     &             71,12,52,53,44,24,13,11,20,40,51,
     &             20,24,70,44,40/
      DATA LMATHC /12,52,50,
     &             72,11,20,31,76,36,47,56,70,42,40,20,22,42,
     &             16,27,37,54,52,40,20,12,13,24,44,53,
     &             17,24,30,44,70,24,44,57,
     &             20,27,70,17,57,70,47,40,
     &             20,24,70,14,54,70,44,40,
     &             30,14,54,30,
     &             41,11,70,13,43,70,34,52,30,
     &             14,44,53,51,40,10,
     &             14,11,20,40,51,54,
     &             71,13,24,20,70,30,34,54,50,30/
C
C          THE FOLLOWING SPECIFY THE MARKER SYMBOLS:
C
      DATA LMARKA /10,34,50,10,
     &             10,32,34,10,50,32,70,34,50,
     &             30,12,34,52,30,
     &             30,31,70,33,34,70,12,22,70,42,52,
     &             10,21,70,43,54,70,14,23,70,41,50,
     &             32,
     &             21,43,70,34,30,70,41,23,70,12,52,
     &             10,14,54,50,10,70,30,34,70,12,52,
     &             30,34,12,52,30,12,70,34,52,
     &             20,11,13,24,44,53,51,40,20,70,30,34,70,12,52,
     &             30,31,22,70,12,22,33,70,34,33,42,70,31,42,52,
     &             10,21,23,70,14,23,43,70,54,43,41,70,21,41,50,
     &             10,34,50,10,70,32,
     &             30,14,54,30,70,32,
     &             30,32,14,30,54,32,70,14,54,
     &             10,14,54,50,10,70,32,
     &             30,12,34,52,30,70,32,
     &             20,11,13,24,44,53,51,40,20,70,32,
     &             30,31,70,32,70,33,34,70,12,22,70,42,52/
      DATA LMARKB /10,21,70,32,70,43,54,70,14,23,70,41,50,
     &             32,53,51,13,11,32,44,24,40,20,32,
     &             12,52,70,54,10,70,30,34,70,14,50,
     &             10,50,14,54,10,14,70,54,50,
     &             30,12,34,52,30,70,21,43,70,23,41,
     &             20,11,13,24,44,53,51,40,20,70,10,54,70,14,50,
     &             30,31,22,70,12,22,33,70,34,33,42,70,32,70,31,42,52,
     &             10,21,23,70,14,23,43,70,54,43,41,70,32,70,21,41,50/
C
C          THE FOLLOWING SPECIFY THE STANDARD PART OF FONT-2:
C
      DATA LFON2A /10,17,57,56,
     &             10,37,50,10,
     &             21,12,15,26,46,55,52,41,21,70,20,40,70,30,37,70,27,
     &                                                             47,
     &             10,37,50,
     &             12,15,27,47,55,52,40,20,12,70,23,25,70,24,44,70,45,
     &                                                             43,
     &             20,40,70,30,37,70,47,27,70,16,13,22,42,53,56,
     &             10,20,12,15,27,47,55,52,40,50,
     &             11,10,50,51,70,56,57,17,16,70,25,23,70,24,44,70,45,
     &                                                             43,
     &             50,43,34,24,13,11,20,30,41,54,
     &             11,16,27,47,56,55,44,14,70,44,53,51,40,20,11,72,10,
     &             72,30,32,70,16,25,32,45,56,
     &             44,24,13,11,20,40,51,53,44,16,27,47,56,
     &             72,22,13,15,26,46,55,53,42,22,70,20,74,46,
     &             72,10,56,70,16,26,40,50,
     &             34,30,40,
     &             72,12,16,70,15,26,46,55,50/
      DATA LFON2B /14,21,70,10,54,70,43,50,
     &             10,34,70,17,34,50,
     &             72,10,16,70,13,22,42,53,56,
     &             14,33,40,54,
     &             14,15,27,47,55,54,14,12,20,40,52,54,
     &             72,10,15,26,46,55,53,42,22,13,
     &             20,11,13,24,54,70,44,53,51,40,20,
     &             30,34,70,13,24,54,
     &             14,11,20,40,51,53,44,
     &             72,30,37,70,16,13,22,42,53,56,
     &             24,13,11,20,31,33,70,31,40,51,53,44,
     &             17,46,70,56,46,15,14,43,70,53,43,12,11,20,50,73,50,
     &                                                             40,
     &             17,26,46,70,57,46,22,21,30,50,73,50,40/
C
C          THE FOLLOWING SPECIFY THE EXTENDED PART OF FONT-2:
C
      DATA LFON2C /15,26,27,37,36,15,
     &             35,16,17,27,26,35/
C
C          THE FOLLOWING SPECIFY THE STANDARD PART OF FONT-3:
C
      DATA LFON3A /14,44,53,51,40,10,17,57,56,
     &             27,20,70,10,40,47,70,40,50,73,50,
     &             10,11,51,50,70,41,47,70,57,27,70,37,21,
     &             10,50,52,70,55,57,17,70,27,20,70,24,44,70,45,43,
     &             10,30,70,20,27,70,17,57,56,
     &             17,10,57,50,
     &             75,17,26,46,57,74,70,17,10,57,50,
     &             10,30,70,20,27,70,17,37,70,24,34,47,57,70,34,40,50,
     &             11,10,20,37,70,27,57,70,47,40,70,30,50,
     &             10,17,30,57,50,
     &             10,30,70,20,27,70,17,47,56,54,43,23,
     &             51,40,20,12,15,27,47,56,
     &             16,17,57,56,70,37,30,70,20,40,
     &             11,20,31,17,70,57,31,
     &             10,20,27,17,70,27,47,56,55,44,24,70,44,53,51,40,20,
     &             17,14,23,43,70,47,40,70,30,50,
     &             27,17,10,30,41,43,34,14,70,50,57,
     &             12,11,20,40,51,53,44,55,56,47,27,16,70,24,44,
     &             13,24,44,53,51,40,20,11,14,25,56/
      DATA LFON3B /10,50,73,50,74,70,40,44,70,24,20,
     &             10,11,51,50,70,21,34,70,24,54,70,44,41,
     &             11,13,24,44,53,51,40,20,11,70,25,34,45,70,34,30,73,
     &                                                    20,70,40,31,
     &             10,30,70,20,24,70,14,54,53,
     &             14,10,54,50,
     &             14,10,54,50,70,55,44,24,15,
     &             10,30,70,20,24,70,14,34,70,22,32,44,54,70,32,40,50,
     &             11,10,20,34,70,24,54,70,44,40,70,30,50,
     &             10,14,30,54,50,
     &             10,14,70,12,52,70,54,50,
     &             21,30,40,51,53,44,34,23,70,24,20,72,20,70,10,30,
     &             20,40,70,30,34,70,13,14,54,53,
     &             14,30,70,54,30,72,20,11,
     &             10,40,51,42,53,44,14,70,24,20,70,22,42,
     &             10,50,70,40,44,70,34,30,70,20,24,
     &             24,14,10,30,41,32,12,70,54,50,
     &             11,20,40,51,42,53,44,24,13,70,42,22/
C
C          THE FOLLOWING SPECIFY THE EXTENDED PART OF FONT-3:
C
      DATA LFON3C /10,24,17,70,27,47,70,37,30,70,20,40,70,50,44,24,70,
     &                                                          44,57,
     &             10,22,14,70,24,44,70,34,30,70,20,40,70,50,42,22,70,
     &                                                          42,54,
     &             14,12,21,41,70,44,40,70,30,50,
     &             10,50,70,40,47,70,37,30,70,20,27,
     &             10,50,73,50,74,70,40,47,70,37,30,70,20,27,
     &             10,50,73,50,74,70,40,44,70,34,30,70,20,24,
     &             10,40,51,53,44,24,70,20,27,70,37,17,16,
     &             10,40,51,42,22,70,20,24,70,34,14,13,
     &             10,40,51,53,44,24,70,20,27,70,37,17,
     &             10,40,51,42,22,70,20,24,70,14,34,
     &             16,27,47,55,52,40,20,11,12,70,24,54,
     &             13,24,44,53,51,40,20,11,70,22,52,
     &             10,17,70,14,24,25,37,47,55,52,40,30,22,24,
     &             10,14,70,12,22,23,34,44,53,51,40,30,21,22,
     &             10,20,34,25,26,37,57,50,70,54,34,
     &             10,20,32,23,34,54,50,70,52,32/
      DATA LFON3D /10,50,52,70,55,57,17,70,27,20,70,24,44,70,45,43,75,
     &                                              70,17,27,70,47,57,
     &             12,52,53,44,24,13,11,20,40,51,70,15,25,70,45,55/
C
C          DATA INITIALISATION OF THE UNIQUE-CHAR. INDEX:
C
      DATA NDXS1 /   0, 0,     0, 0,     0, 0,
     &               0,11,     0,11,     0,11,
     &              11, 5,    11, 5,    11, 5,
     &              16,11,    16,11,    16,11,
     &              27,16,    27,16,    27,16,
     &              43,11,    43,11,    43,11,
     &              54,12,    54,12,    54,12,
     &              66, 2,    66, 2,    66, 2,
     &              68, 4,    68, 4,    68, 4,
     &              72, 4,    72, 4,    72, 4,
     &              76, 8,    76, 8,    76, 8,
     &              84, 5,    84, 5,    84, 5,
     &              89, 6,    89, 6,    89, 6,
     &              95, 2,    95, 2,    95, 2,
     &              97, 5,    97, 5,    97, 5,
     &             102, 2,   102, 2,   102, 2/
      DATA NDXS2 / 104, 9,   104, 9,   104, 9,
     &             113, 3,   113, 3,   113, 3,
     &             116, 8,   116, 8,   116, 8,
     &             124, 9,   124, 9,   124, 9,
     &             133, 6,   133, 6,   133, 6,
     &             139, 8,   139, 8,   139, 8,
     &             147,10,   147,10,   147,10,
     &             157, 6,   157, 6,   157, 6,
     &             163,16,   163,16,   163,16,
     &             179,10,   179,10,   179,10,
     &             189,11,   189,11,   189,11,
     &             200,12,   200,12,   200,12,
     &             212, 3,   212, 3,   212, 3,
     &             215, 5,   215, 5,   215, 5,
     &             220, 3,   220, 3,   220, 3,
     &             223,14,   223,14,   223,14/
      DATA NDXS3 / 237,16,   237,16,   237,16,
     &             253, 8,   253, 8,   253, 8,
     &             261,12,   261,12,  1821, 9,
     &             273, 8,  1510, 4,  1830,11,
     &             281, 7,  1514, 4,  1841,13,
     &             288, 7,   288, 7,  1854,16,
     &             295, 6,  1518,18,  1518,18,
     &             301, 9,  1510, 4,  1870, 9,
     &             310, 8,   419, 5,   419, 5,
     &             318, 8,   318, 8,  1879, 4,
     &             326, 6,   310, 8,  1883,11,
     &             332, 6,   332, 6,  1894,17,
     &             338, 3,  1536, 3,  1911,13,
     &             341, 5,   341, 5,  1924, 5,
     &             346, 4,   346, 4,   310, 8,
     &             350, 9,   350, 9,   350, 9/
      DATA NDXS4 / 359, 7,  1179, 8,  1179, 8,
     &             366,12,  1539,18,   350, 9,
     &             378,10,   359, 7,  1929,12,
     &             388,12,  1079, 7,  1941, 8,
     &             400, 5,   400, 5,  1949,10,
     &             405, 6,   424, 6,  1959, 7,
     &             411, 3,  1557,15,  1966,17,
     &             414, 5,  1572,10,  1983,10,
     &             419, 5,  1582,18,   419, 5,
     &             424, 6,   424, 6,  1993,11,
     &             430, 4,   430, 4,  2004,15,
     &             434, 4,   434, 4,   434, 4,
     &             438, 2,   438, 2,   438, 2,
     &             440, 4,   440, 4,   440, 4,
     &             444, 3,   444, 3,   444, 3,
     &             447, 3,   447, 3,   447, 3/
      DATA NDXS5 / 450, 2,   450, 2,   450, 2,
     &             452,12,  1600,10,   452,12,
     &             464,11,  1610,17,  2019,11,
     &             475, 8,  1627, 9,  2030,11,
     &             483,11,  1636,13,  2041,13,
     &             494,10,  1086,11,   494,10,
     &             504, 7,  1649,14,  2054,21,
     &             511,15,  1627, 9,  2075, 9,
     &             526, 8,  1663, 8,   648, 5,
     &             534, 4,  1671, 3,  2084, 4,
     &             538, 7,  1674, 9,  2088, 9,
     &             545, 6,  1683, 8,  2097,17,
     &             551, 4,  1691, 6,  2114,13,
     &             555,12,  1697, 9,  2127, 5,
     &             567, 8,  1706, 4,  2132, 8,
     &             575, 9,   575, 9,   575, 9/
      DATA NDXS6 / 584,12,  1187, 8,  1187, 8,
     &             596,12,  1710,12,   575, 9,
     &             608, 7,  1722,10,  2140,16,
     &             615,10,  1732,11,   475, 8,
     &             625, 7,  1743, 6,  2156,10,
     &             632, 8,  1749, 7,  2166, 8,
     &             640, 3,  1756,10,  2174,13,
     &             643, 5,  1766,12,  2258,10,
     &             648, 5,  1778,18,   648, 5,
     &             653, 7,  1749, 7,  2198,10,
     &             660, 4,  1796,13,  2208,12,
     &             664, 8,   664, 8,   664, 8,
     &             672, 2,   672, 2,   672, 2,
     &             674, 8,   674, 8,   674, 8,
     &             682, 4,   682, 4,   682, 4,
     &               0, 0,     0, 0,     0, 0/
      DATA NDXS7 / 686,12,  1809, 6,  2220,19,
     &             698,12,  1815, 6,  2239,19,
     &             710,11,    16,11,  1983,10,
     &             721,16,    16,11,  2258,10,
     &             737,11,    16,11,  2268,11,
     &             748,13,    16,11,  2187,11,
     &             761,11,    16,11,  2279,14,
     &             772,14,    16,11,  2293,14,
     &             786, 6,    16,11,  2307,13,
     &             792, 4,    16,11,  2320,12,
     &             796, 3,    16,11,  2332,12,
     &             799,12,    16,11,  2344,11,
     &             811, 3,    16,11,  2355,12,
     &             814, 4,    16,11,  2367,11,
     &             818, 6,    16,11,  2378,14,
     &             824, 5,    16,11,  2392,14/
      DATA NDXS8 / 829, 5,    16,11,  2406,11,
     &             834, 3,    16,11,  2417,10,
     &             837, 2,    16,11,  2427,23,
     &             839,11,    16,11,  2450,16,
     &             850, 3,    16,11,    16,11,
     &             853, 6,    16,11,    16,11,
     &             859, 5,    16,11,    16,11,
     &             864, 5,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11,
     &              16,11,    16,11,    16,11/
C
C          DATA INITIALISATION OF THE COMMON-CHAR. INDEX:
C
      DATA NDXC1 /  84, 5,    76, 8,   648, 5,   869, 8,
     &             215, 5,   877, 8,   885, 4,   212, 3,
     &             889, 6,   895, 7,   902, 6,   908, 6,
     &             914, 5,   919,17,   936,17,   953, 2,
     &              95, 2,   955, 6,   102, 2,   961, 8,
     &             969, 8,   977, 9,   986, 7,   220, 3,
     &             993, 6,   999, 7,  1006, 6,  1012, 6,
     &            1018, 5,   189,11,  1023,23,  1046, 5,
     &            1051, 2,  1053, 5,  1058, 8,  1066, 6,
     &            1072, 7,  1079, 7,  1086,11,  1097, 3,
     &            1100, 5,  1105, 9,  1114, 6,  1120, 6,
     &            1126,11,    68, 4,   434, 4,   664, 8/
      DATA NDXC2 /1137, 5,  1142, 3,  1145,14,  1159,12,
     &            1171, 8,  1179, 8,  1187, 8,   640, 3,
     &            1195, 4,  1199, 9,  1208, 6,  1214, 6,
     &            1220,10,    72, 4,   440, 4,   674, 8,
     &            1230, 4,  1195, 4,  1234, 9,  1100, 5,
     &            1243, 5,   575, 9,  1248,11,  1259,11,
     &              84, 5,  1270, 1,  1271,11,  1282,11,
     &            1293, 9,  1302,15,  1317,15,  1332,15,
     &            1347, 6,  1353, 6,  1359, 9,  1368, 7,
     &            1375, 7,  1382,11,  1393,13,  1406,13,
     &             648, 5,  1419,11,  1430,11,  1441, 9,
     &            1450,11,  1461,15,  1476,17,  1493,17/
C
C
C          FOR CHAR. NUMBERS UP TO 159, THE UNIQUE-CHAR. INDEX
C          IS USED, AND THE CURRENT FONT IS ALSO REQUIRED. FOR
C          CHAR. NUMBERS ABOVE THIS, THE CHARS ARE THE SAME FOR
C          ALL FONTS, SO ONLY THE COMMON-CHAR. INDEX IS USED.
C          IF THE REQUIRED CHARACTER IS A UNIQUE ONE IN FONT-0,
C          THE REDEFINED CHAR. LIST [KNUM] IS SCANNED FIRST TO
C          SEE IF THE CHAR. HAS BEEN AMENDED. IF IT HASN'T BEEN
C          REDEFINED, THE CHARACTER IS TAKEN FROM FONT-1 INSTEAD.
C          IF IT HAS BEEN REDEFINED, THE NEW SPECIFICATION IS
C          COPIED FROM [KSPEC] VIA THE INDICES [KPOSN] AND [KLEN].
C
      NCHAR= ICHAR
      NFONT= IFONT
      IF (NFONT.LT.0.OR.NFONT.GT.3) NFONT= 1
      IF (NCHAR.GE.160)   GO TO 4
      IF (NFONT.NE.0)     GO TO 3
      IF (NDEFS.LT.KSTRT) GO TO 2
C
C          THIS SECTION DEALS WITH RE-DEFINABLE CHARACTERS.
C
      IPOSN= KSTRT
C
      DO 100 LOOK= KSTRT,NDEFS
        IF (NCHAR.EQ.KNUM(LOOK)) GO TO 1
C
        IPOSN= IPOSN+1
  100 CONTINUE
C
      IF (NCHAR.LT.32) NCHAR= 32
      GO TO 2
C
    1 LENGTH= KLEN(IPOSN)
      IF (LENGTH.EQ.0) RETURN
C
      IFROM= KPOSN(IPOSN)
C
      DO 200 ICOPY= 1,LENGTH
        IFROM= IFROM+1
        ICODE= KSPEC(IFROM)
        IXPTS(ICOPY)= ICODE/10
        IYPTS(ICOPY)= MOD(ICODE,10)
  200 CONTINUE
      RETURN
C
C          THIS SECTION DEALS WITH ALL PREDEFINED CHARACTERS.
C
    2 NFONT= 1
    3 IFROM= INDEXS(1,NFONT,NCHAR-31)
      LENGTH= INDEXS(2,NFONT,NCHAR-31)
      GO TO 5
C
    4 IFROM= INDEXC(1,NCHAR-159)
      LENGTH= INDEXC(2,NCHAR-159)
    5 IF (LENGTH.EQ.0) RETURN
C
      DO 300 ICOPY= 1,LENGTH
        IFROM= IFROM+1
        ICODE= ISPECS(IFROM)
        IXPTS(ICOPY)= ICODE/10
        IYPTS(ICOPY)= MOD(ICODE,10)
  300 CONTINUE
C
      RETURN
      END
