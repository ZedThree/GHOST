      SUBROUTINE G3INIT(ITYPE)
C
C          ------------------------------------------------
C          ROUTINE NO. (3002)   VERSION (A8.3C)   09:OCT:97
C          ------------------------------------------------
C
C          THIS INITIALISES GHOST STATE VARIABLES.
C          (THIS VERSION IS FOR DUAL-MODE WORKING).
C
C
C     ******************************************************************
C     *                                                                *
C     *    NOTE: ALL GHOST DEVICE-INDEPENDENT COMMON BLOCKS ARE        *
C     *          SPECIFIED HERE. TO ENSURE THEIR INTEGRITY IT IS       *
C     *          ESSENTIAL THAT THIS ROUTINE CANNOT BE SWAPPED-OUT.    *
C     *                                                                *
C     ******************************************************************
C
C
C          <ITYPE> CONTROLS THE ACTION AS FOLLOWS:
C
C          =  1, INITIALISATION IS DONE UNCONDITIONALLY.
C          =  2, INITIALISATION IS DONE ONLY IF NOT ALREADY DONE.
C
C
      REAL    HTANGA(24,2),HTANGB(24,2)
      INTEGER IPITHA(24,2),IHATA(24),
     &        IHMKAB(24,2),IHMSAB(24,2),IHMKBB(24,2),IHMSBB(24,2),
     &        IPHASB(24,2),IPITHB(24,2),IPSFTB(24,2)
      LOGICAL DONE
      LOGICAL TYPMOD,KHRDW1,OPEN,LHRDW1,OPCURV,FULL,NEWPIC,INTRAC,
     &        SCRTCH,FIRST,READY,FINPIC,ERRON,GFOPEN,PPOPEN,BOUND,PSPP,
     &        SHIFT0,SHIFT1,CURTRA,WINLIN,WNDOIN,MASKIN,LINSAV
C
      COMMON /T0AARG/ KAXIS
      COMMON /T0ACON/ ANGCON
      COMMON /T0ADIX/ DIVLX,NTIKLX,NTIKHX
      COMMON /T0ADIY/ DIVLY,NTIKLY,NTIKHY
      COMMON /T0ANOD/ KDIRX,KDIRY
      COMMON /T0ANOX/ KANNX,NCHRSX,NAFTPX
      COMMON /T0ANOY/ KANNY,NCHRSY,NAFTPY
      COMMON /T0APOS/ AXPOSX,AXPOSY
      COMMON /T0ASKX/ NSKIPX,NDECSX
      COMMON /T0ASKY/ NSKIPY,NDECSY
      COMMON /T0ATIC/ MTICKS
      COMMON /T0ATIK/ TKEN1A,TKEN1B,TKEN2A,TKEN2B
      COMMON /T0ATYP/ KTYPEX,KTYPEY
      COMMON /T0AUTM/ MAPNUM
      COMMON /T0BANG/ B3ANG
      COMMON /T0BASP/ SIZRAT
      COMMON /T0BBAS/ IBSTYP,BSORIG,BSMAX
      COMMON /T0BKLM/ KMTHOD
      COMMON /T0BRTY/ IBRTYP
      COMMON /T0BUFN/ KBUFR0
      COMMON /T0CANG/ STANG0,CRANG0
      COMMON /T0CATT/ IUNDL0,ITAL0
      COMMON /T0CDIM/ MAGN0,OBLAT0
      COMMON /T0CFON/ KFONT0
      COMMON /T0CLBL/ LLBCON
      COMMON /T0CNLB/ LBLCON(10,50)
      COMMON /T0CNSV/ XPOSNS(100),YPOSNS(100),NCOPTS
      COMMON /T0COMS/ NOWCOM,NOWNUM
      COMMON /T0CSIZ/ CSIZE,MRKSIZ
      COMMON /T0CSLO/ SLOPE,MRKSLP
      COMMON /T0CSPA/ X1CHR0,X2CHR0,Y1CHR0,Y2CHR0
      COMMON /T0CURV/ MCURV0
      COMMON /T0CVIS/ KWIND0,KMASK0
      COMMON /T0DBND/ IDRBND
      COMMON /T0DEVS/ KCHAN0(5),IRESL0
      COMMON /T0FLTY/ IFLTY0,IFLRP0
      COMMON /T0HANG/ HTANG0(255,2)
      COMMON /T0HCOL/ IHCOL0(255,2)
      COMMON /T0HFLG/ NHFLG0(255)
      COMMON /T0HLST/ IHMKA0(255,2),IHMSA0(255,2),IHMKB0(255,2),
     &                IHMSB0(255,2)
      COMMON /T0HNUM/ IHATN0
      COMMON /T0HOFF/ ISHFT0(255,2)
      COMMON /T0HPHS/ IPHAS0(255,2)
      COMMON /T0HPIT/ IPITH0(255,2)
      COMMON /T0HPSF/ IPSFT0(255,2)
      COMMON /T0HRDC/ KHRDW0
      COMMON /T0HRDL/ LHRDW0
      COMMON /T0HTYP/ IHAT0(255)
      COMMON /T0KBAC/ KOLBA0
      COMMON /T0KFIL/ KOLFL0
      COMMON /T0KLAB/ LABCL0(100),LENLAB
      COMMON /T0KLST/ LSTCL0(100),LENLST
      COMMON /T0KMAT/ MATCL0(55,55),MTROWS,MTCOLS
      COMMON /T0KSYS/ KOLSYS
      COMMON /T0KTAB/ REDCO0(255),GRNCO0(255),BLUCO0(255),NCOLS0
      COMMON /T0KTFL/ NCFLG0(255)
      COMMON /T0LATT/ KOLIN0,ITHIK0
      COMMON /T0LPAT/ MARKA0,MISSA0,MARKB0,MISSB0
      COMMON /T0MACT/ MRKMAP,MRKWIN
      COMMON /T0MAPA/ X1MAPV,X2MAPV,Y1MAPV,Y2MAPV
      COMMON /T0MAPD/ X1MAPD,X2MAPD,Y1MAPD,Y2MAPD
      COMMON /T0MAPP/ X1MAP0,X2MAP0,Y1MAP0,Y2MAP0
      COMMON /T0MAPS/ ORIMX0,ORIMY0,SCAMX0,SCAMY0
      COMMON /T0MAPT/ MAPNO0
      COMMON /T0MASK/ X1MSK0(10),X2MSK0(10),Y1MSK0(10),Y2MSK0(10),MSKLV0
      COMMON /T0MRKS/ MARKC0
      COMMON /T0MULF/ INFLGS(100)
      COMMON /T0NOTA/ NOTATA
      COMMON /T0NOTC/ NOTATC
      COMMON /T0PIAN/ ANGPIE
      COMMON /T0PILM/ MPIELB
      COMMON /T0PPOS/ XPLOT0,YPLOT0
      COMMON /T0SANG/ TLTANG
      COMMON /T0SAXE/ INDAXE,XAXORG,YAXORG,XAXDEL,YAXDEL
      COMMON /T0SAZA/ AZIANG
      COMMON /T0SBAS/ IUNDRS,INDBAS,BASEHT
      COMMON /T0SCOL/ LINCUP,LINCLW,LINCBS
      COMMON /T0SCON/ JCONTR
      COMMON /T0SIND/ ISURIN
      COMMON /T0SKOL/ HUESHD,JKOLS,KOLSTA
      COMMON /T0SLIT/ ALIGHT,BLIGHT,CLIGHT
      COMMON /T0SREF/ AMBINT,DIFFUS,SPECT
      COMMON /T0SSCA/ SHTMIN,SHTMAX,XPTCH
      COMMON /T0SUPF/ MAGBUF(5),MAGLVL
      COMMON /T0TRAC/ IPRINT
      COMMON /T0TRAN/ SCALX0,SCALY0,ROTAT0,RPICX0,RPICY0,RDEVX0,RDEVY0,
     &                VRPICX,VRPICY,VRDEVX,VRDEVY
      COMMON /T0TRST/ SHIFT0,MTRAN0,KLIPM0
      COMMON /T0WNDO/ X1WND0,X2WND0,Y1WND0,Y2WND0
      COMMON /T1BEPT/ IXFINI,IYFINI
      COMMON /T1BFSV/ LENFLB
      COMMON /T1BUFN/ KBUFR1
      COMMON /T1BUFS/ MSYSTB(200),LIMSYS,ISYSTP
      COMMON /T1BUFU/ MUSERB(3200),LENTHB,KINDEX,KLIMIT,KAREA,LIMARE,
     &                IAREAP(16),ISTRTA(16),KAREAS(16),NAREAS(16),
     &                INEXTA(32),FULL
      COMMON /T1C2SV/ LPSAV(4)
      COMMON /T1C5SV/ LINESV(4),ITHIKS,NFILLS,LINSAV
      COMMON /T1CANG/ STANG1,CRANG1
      COMMON /T1CANU/ STANGU,CRANGU
      COMMON /T1CATT/ IUNDL1,ITAL1
      COMMON /T1CDCC/ SINCHR,COSCHR
      COMMON /T1CDCS/ SINSTR,COSSTR
      COMMON /T1CDEF/ KSTRT,NDEFS,KNUM(30),KPOSN(30),KLEN(30),KSPEC(500)
      COMMON /T1CDIM/ MAGN1,OBLAT1
      COMMON /T1CFCH/ KFNTCH
      COMMON /T1CFIN/ INDLEN(2,256),WIDCHR(256)
      COMMON /T1CFON/ KFONT1
      COMMON /T1CHAD/ KDISPI,KDISPO
      COMMON /T1CJUS/ JUSTYP
      COMMON /T1CMOC/ ADDSPX,ADDLNX,ADDSPY,ADDLNY
      COMMON /T1CMOD/ TYPMOD
      COMMON /T1CMOV/ ADDSP,ADDLN
      COMMON /T1CPOS/ XCHAR,YCHAR
      COMMON /T1CRSV/ XCVSAV(3),YCVSAV(3),INDXCV,ICVPTR,
     &                DX1CV,DY1CV,XI1CV,YI1CV,NCVPTS,CUBX1,CUBY1
      COMMON /T1CSPA/ X1CHR1,X2CHR1,Y1CHR1,Y2CHR1
      COMMON /T1CURV/ MCURV1,OPCURV
      COMMON /T1CVIS/ KWIND1,KMASK1
      COMMON /T1DENA/ OPEN
      COMMON /T1DEVS/ KCHAN1(5),IRESL1
      COMMON /T1FLBF/ IXSAVE(1000),IYSAVE(1000),ISAVSZ,INDSAV
      COMMON /T1FLSV/ BOUND
      COMMON /T1FLTY/ IFLTY1,IFLRP1
      COMMON /T1FUND/ NUMFUN,LENARG
      COMMON /T1HANG/ HTANG1(255,2)
      COMMON /T1HCOL/ IHCOL1(255,2)
      COMMON /T1HLST/ IHMKA1(255,2),IHMSA1(255,2),IHMKB1(255,2),
     &                IHMSB1(255,2)
      COMMON /T1HNUM/ IHATN1
      COMMON /T1HOFF/ ISHFT1(255,2)
      COMMON /T1HPHS/ IPHAS1(255,2)
      COMMON /T1HPIT/ IPITH1(255,2)
      COMMON /T1HPSF/ IPSFT1(255,2)
      COMMON /T1HRDC/ KHRDW1
      COMMON /T1HRDL/ LHRDW1
      COMMON /T1HRSV/ LHDEF
      COMMON /T1HTYP/ IHAT1(255)
      COMMON /T1KBAC/ KOLBA1
      COMMON /T1KFIL/ KOLFL1
      COMMON /T1KTAB/ REDCO1(255),GRNCO1(255),BLUCO1(255),NCOLS1
      COMMON /T1KTFL/ NCFLG1(255)
      COMMON /T1LAND/ LNDSCP
      COMMON /T1LATT/ KOLIN1,ITHIK1
      COMMON /T1LIND/ PATREM
      COMMON /T1LOCD/ XLOCAD,YLOCAD
      COMMON /T1LOCV/ XLOCAV,YLOCAV
      COMMON /T1LPAT/ MARKA1,MISSA1,MARKB1,MISSB1
      COMMON /T1LVIS/ WINLIN,WNDOIN,MASKIN
      COMMON /T1MAPP/ X1MAP1,X2MAP1,Y1MAP1,Y2MAP1
      COMMON /T1MAPS/ ORIMX1,ORIMY1,SCAMX1,SCAMY1
      COMMON /T1MAPT/ MAPNO1
      COMMON /T1MASK/ X1MSK1(10),X2MSK1(10),Y1MSK1(10),Y2MSK1(10),MSKLV1
      COMMON /T1MRKS/ MARKC1
      COMMON /T1PNUM/ NDPICS
      COMMON /T1PPAT/ XPLOTA,YPLOTA
      COMMON /T1PPBT/ XPLOTB,YPLOTB
      COMMON /T1POSP/ PSPP
      COMMON /T1PPOS/ XPLOT1,YPLOT1
      COMMON /T1REPN/ NREPLC
      COMMON /T1SHVS/ ISHRTX,ISHRTY,CLONGX,CLONGY
      COMMON /T1SPEC/ XSPEC(4600),YSPEC(4600),ICHPTR(128),NEXTPT,NSTORE
      COMMON /T1TCOB/ XCBX,XCBY,YCBX,YCBY,RPICXB,RPICYB,RDEVXB,RDEVYB
      COMMON /T1TCOC/ XCCX,XCCY,YCCX,YCCY,RPICXC,RPICYC,RDEVXC,RDEVYC,
     &                CURTRA
      COMMON /T1TCOR/ XRVX,XRVY,YRVX,YRVY,RPICXR,RPICYR,RDEVXR,RDEVYR
      COMMON /T1TRNC/ SCALXC,SCALYC,ROTATC
      COMMON /T1TRNS/ SCALXS,SCALYS,ROTATS,RDEVXS,RDEVYS
      COMMON /T1TRST/ SHIFT1,MTRAN1,KLIPM1,INDLVL
      COMMON /T1TSPA/ X1TYPW,X2TYPW,Y1TYPW,Y2TYPW
      COMMON /T1TYPQ/ IQUAD
      COMMON /T1WNDO/ X1WND1,X2WND1,Y1WND1,Y2WND1
      COMMON /T2BUFF/ IBUFFR(512),INDEXB,IBLOKL
      COMMON /T2COMM/ FIRST,IFILCO
      COMMON /T2HEDR/ IHEADR(1024)
      COMMON /T2IDEN/ IDGRID
      COMMON /T2INFI/ INFOFI(32),INFOPI(32)
      COMMON /T2INFO/ INFOFO(32),INFOPO(32)
      COMMON /T2INLI/ LNFOFI,LNFOPI
      COMMON /T2INLO/ LNFOFO,LNFOPO
      COMMON /T2OPNA/ NAMEFO(32),NAMEPO(4)
      COMMON /T2OPNL/ LNFILN,LNPICN
      COMMON /T2PHED/ LPIHED
      COMMON /T2PNUM/ NGPICS,LIMPIC
      COMMON /T2RECC/ NBLOKS,NXTBLK,NXTFRE,MAXBLK,FINPIC
      COMMON /T2SAVE/ SCRTCH
      COMMON /T2USEN/ LASTFI(32,2),LASTPI(4)
      COMMON /T2USES/ READY(2),LASTPN,KFILE
      COMMON /T3CONS/ PI
      COMMON /T3DEVT/ INTRAC
      COMMON /T3ERRS/ ERRON,NUMERR
      COMMON /T3FILL/ LENDEF,LENSCR
      COMMON /T3FILN/ NAMDEF(32),NAMSCR(32)
      COMMON /T3MODE/ KMODE
      COMMON /T3OUTS/ GFOPEN,PPOPEN
      COMMON /T3PICM/ NEWPIC
      COMMON /T3PLVL/ LVLPIC
      COMMON /T3SHUT/ K1ERR,K2ERR
      COMMON /T3VBUF/ VBUFFR(63),LASCOD,INDXVB
C
      SAVE DONE
C
      DATA HTANGA /0.0,1.570796,-0.785398,0.785398,
     &             0.0,0.785398,0.523599,1.047198,
     &             0.0,1.570796,-0.785398,0.785398,
     &             0.0,0.785398,0.523599,1.047198,
     &             0.0,1.570796,-0.785398,0.785398,
     &             0.0,0.785398,0.523599,1.047198,
     &             0.0,1.570796,-0.785398,0.785398,
     &             1.570796,-0.785398,-0.523599,-1.047198,
     &             0.0,1.570796,-0.785398,0.785398,
     &             1.570796,-0.785398,-0.523599,-1.047198,
     &             0.0,1.570796,-0.785398,0.785398,
     &             1.570796,-0.785398,-0.523599,-1.047198/
      DATA HTANGB /0.0,0.785398,0.0,0.785398,0.0,0.0,0.0,
     &             0.785398,0.785398,0.785398,0.0,0.785398,
     &             0.0,0.785398,0.0,0.785398,0.0,0.0,0.0,
     &             0.785398,0.785398,0.785398,0.0,0.785398,
     &             1.570796,-0.785398,1.570796,-0.785398,
     &             1.570796,1.570796,1.570796,-0.785398,
     &             -0.785398,-0.785398,1.570796,-0.785398,
     &             1.570796,-0.785398,1.570796,-0.785398,
     &             1.570796,1.570796,1.570796,-0.785398,
     &             -0.785398,-0.785398,1.570796,-0.785398/
      DATA IPITHA /10,10,10,10,10,10,10,10,20,20,20,20,
     &             20,20,20,20,5,5,5,5,5,5,5,5,
     &             10,10,10,10,10,10,10,10,20,20,20,20,
     &             20,20,20,20,5,5,5,5,5,5,5,5/
      DATA IHATA  /1,1,1,1,3,3,3,3,1,1,1,1,3,3,3,3,
     &             1,1,1,1,3,3,3,3/
      DATA IHMKAB /8,8,10,10,0,0,40,20,20,20,30,30,
     &             4,4,5,5,0,0,20,10,10,10,15,14,
     &             8,8,10,10,10,15,40,20,20,20,20,30,
     &             4,4,5,5,5,8,20,10,10,10,10,14/
      DATA IHMSAB /12,12,10,10,0,0,20,20,10,10,20,10,
     &             6,6,5,5,0,0,10,10,5,5,10,6,
     &             12,12,10,10,10,15,20,20,10,10,10,10,
     &             6,6,5,5,5,8,10,10,5,5,5,6/
      DATA IHMKBB /8,8,10,10,0,0,40,20,20,20,30,30,
     &             4,4,5,5,0,0,20,10,10,10,15,14,
     &             8,8,10,10,10,15,40,20,20,20,10,30,
     &             4,4,5,5,5,8,20,10,10,10,5,14/
      DATA IHMSBB /12,12,10,10,0,0,20,20,10,10,20,10,
     &             6,6,5,5,0,0,10,10,5,5,10,6,
     &             12,12,10,10,10,15,20,20,10,10,10,10,
     &             6,6,5,5,5,8,10,10,5,5,5,6/
      DATA IPHASB /0,0,0,0,0,0,110,70,10,50,10,20,
     &             0,0,0,0,0,0,55,35,5,25,5,10,
     &             0,0,0,0,10,15,10,10,10,10,40,20,
     &             0,0,0,0,5,8,5,5,5,5,20,10/
      DATA IPITHB /20,20,10,10,10,15,10,10,10,10,10,20,
     &             10,10,5,5,5,8,5,5,5,5,5,10,
     &             20,20,10,10,15,10,10,10,10,10,10,20,
     &             10,10,5,5,8,5,5,5,5,5,5,10/
      DATA IPSFTB /4,4,0,0,0,0,0,20,10,0,0,15,
     &             2,2,0,0,0,0,0,10,5,0,0,7,
     &             4,4,0,0,0,0,10,0,0,20,20,35,
     &             2,2,0,0,0,0,5,0,0,10,10,17/
      DATA DONE /.FALSE./, CORNRL /-0.11765/, CORNRR /1.05882/
C
C
      IF (DONE.AND.ITYPE.EQ.2) RETURN
C
C          THE MACHINE DEPENDENT VARIABLES ARE INITIALISED
C          AND THE MESSAGE CHANNELS OPENED.
C
      CALL G3SYSI(1)
C
C          THE FOLLOWING ARE PRE-PROCESSOR COMMON BLOCKS:
C          ---------------------------------------------
C
C          ANGLE CONVERSION COEFFICIENT:
C
      ANGCON= 1.7453293E-2
C
C          AXES-DRAWING VALUES:
C
      DIVLX= 0.0
      NTIKLX= 0
      NTIKHX= 0
      DIVLY= 0.0
      NTIKLY= 0
      NTIKHY= 0
      KDIRX= 0
      KDIRY= 0
      AXPOSX= 0.0
      AXPOSY= 0.0
      NSKIPX= 0
      NDECSX= 0
      NSKIPY= 0
      NDECSY= 0
      MTICKS= 15
      KTYPEX= 0
      KTYPEY= 0
C
C          MAPPING TYPE:
C
      MAPNUM= 1
C
C          3-D BARCHART PARAMETERS
C
      B3ANG= 45.0
      SIZRAT= 0.75
      IBSTYP= 0
      BSORIG= 0.0
      BSMAX= 0.0
      KMTHOD= 0
C
C          BARCHART AND HISTOGRAM ORIENTATION:
C
      IBRTYP= 0
C
C          OUTPUT BUFFER NUMBER:
C
      KBUFR0= 0
C
C          CHARACTER VALUES:
C
      STANG0= 0.0
      CRANG0= 0.0
      IUNDL0= 0
      ITAL0= 0
      MAGN0= 10
      OBLAT0= 1.0
      KFONT0= 1
      LLBCON= 0
      NOWCOM= 33
      NOWNUM= 35
      CSIZE= 0.0
      MRKSIZ= 0
      SLOPE= 0.0
      MRKSLP= 0
      X1CHR0= 0.0
      X2CHR0= 0.0
      Y1CHR0= 0.0
      Y2CHR0= 0.0
C
C          CURVE-DRAWING METHOD NUMBER:
C
      MCURV0= 1
C
C          CHARACTER VISIBILITY MODES:
C
      KWIND0= 0
      KMASK0= 0
      IDRBND= 1
C
C          CHANNEL INDICATOR/DEVICE RESOLUTION FACTOR:
C
      KCHAN0(1)= 0
      KCHAN0(2)= 0
      KCHAN0(3)= 0
      KCHAN0(4)= 0
      KCHAN0(5)= 0
      IRESL0= 1
C
C          CROSS-HATCHING VALUES:
C
      IFLTY0= 0
      IFLRP0= 0
      IHATN0= 65
C
      DO 100 ISET= 1,255
        HTANG0(ISET,1)= 0.785398
        HTANG0(ISET,2)= -0.785398
        IHCOL0(ISET,1)= 0
        IHCOL0(ISET,2)= 0
        NHFLG0(ISET)= 0
        IHMKA0(ISET,1)= 0
        IHMKA0(ISET,2)= 0
        IHMSA0(ISET,1)= 0
        IHMSA0(ISET,2)= 0
        IHMKB0(ISET,1)= 0
        IHMKB0(ISET,2)= 0
        IHMSB0(ISET,1)= 0
        IHMSB0(ISET,2)= 0
        ISHFT0(ISET,1)= 0
        ISHFT0(ISET,2)= 0
        IPHAS0(ISET,1)= 0
        IPHAS0(ISET,2)= 0
        IPITH0(ISET,1)= 10
        IPITH0(ISET,2)= 10
        IPSFT0(ISET,1)= 0
        IPSFT0(ISET,2)= 0
        IHAT0(ISET)= 3
  100 CONTINUE
C
      DO 200 ISET= 1,24
        HTANG0(ISET,1)= HTANGA(ISET,1)
        HTANG0(ISET,2)= HTANGA(ISET,2)
        IPITH0(ISET,1)= IPITHA(ISET,1)
        IPITH0(ISET,2)= IPITHA(ISET,2)
        IHAT0(ISET)= IHATA(ISET)
  200 CONTINUE
C
      DO 300 ISET= 33,56
        HTANG0(ISET,1)= HTANGB(ISET-32,1)
        HTANG0(ISET,2)= HTANGB(ISET-32,2)
        IHMKA0(ISET,1)= IHMKAB(ISET-32,1)
        IHMKA0(ISET,2)= IHMKAB(ISET-32,2)
        IHMSA0(ISET,1)= IHMSAB(ISET-32,1)
        IHMSA0(ISET,2)= IHMSAB(ISET-32,2)
        IHMKB0(ISET,1)= IHMKBB(ISET-32,1)
        IHMKB0(ISET,2)= IHMKBB(ISET-32,2)
        IHMSB0(ISET,1)= IHMSBB(ISET-32,1)
        IHMSB0(ISET,2)= IHMSBB(ISET-32,2)
        IPHAS0(ISET,1)= IPHASB(ISET-32,1)
        IPHAS0(ISET,2)= IPHASB(ISET-32,2)
        IPITH0(ISET,1)= IPITHB(ISET-32,1)
        IPITH0(ISET,2)= IPITHB(ISET-32,2)
        IPSFT0(ISET,1)= IPSFTB(ISET-32,1)
        IPSFT0(ISET,2)= IPSFTB(ISET-32,2)
  300 CONTINUE
C
C          CHARACTER/LINE HARDWARE MODES:
C
      KHRDW0= 0
      LHRDW0= 0
C
C          DEFAULT COLOUR DEFINITIONS:
C
      KOLBA0= 0
      KOLFL0= 0
      LENLAB= 0
      LENLST= 0
      MTROWS= 0
      MTCOLS= 0
      KOLSYS= 1
C
      DO 400 NCOLOR= 1,255
        REDCO0(NCOLOR)= 0.0
        GRNCO0(NCOLOR)= 0.0
        BLUCO0(NCOLOR)= 0.0
        NCFLG0(NCOLOR)= 0
  400 CONTINUE
C
      REDCO0(2)= 1.0
      REDCO0(5)= 1.0
      REDCO0(7)= 1.0
      REDCO0(8)= 1.0
      GRNCO0(3)= 1.0
      GRNCO0(5)= 1.0
      GRNCO0(6)= 1.0
      GRNCO0(8)= 1.0
      BLUCO0(4)= 1.0
      BLUCO0(5)= 1.0
      BLUCO0(6)= 1.0
      BLUCO0(7)= 1.0
      NCOLS0= 8
      NCFLG0(1)= 1
      NCFLG0(2)= 1
      NCFLG0(3)= 1
      NCFLG0(4)= 1
      NCFLG0(5)= 1
      NCFLG0(6)= 1
      NCFLG0(7)= 1
      NCFLG0(8)= 1
C
C          LINE ATTRIBUTES/VALUES:
C
      KOLIN0= 0
      ITHIK0= 1
      MARKA0= 0
      MISSA0= 0
      MARKB0= 0
      MISSB0= 0
C
C          MAPPING VALUES:
C
      MRKMAP= 0
      MRKWIN= 0
      X1MAPV= 0.0
      X2MAPV= 1.0
      Y1MAPV= 0.0
      Y2MAPV= 1.0
      X1MAPD= 0.1
      X2MAPD= 0.95
      Y1MAPD= 0.1
      Y2MAPD= 0.95
      X1MAP0= CORNRL
      X2MAP0= CORNRR
      Y1MAP0= CORNRL
      Y2MAP0= CORNRR
      ORIMX0= X1MAP0
      ORIMY0= Y1MAP0
      SCAMX0= 0.85
      SCAMY0= 0.85
      MAPNO0= 1
C
C          MASKING VALUES:
C
      DO 500 ISET= 1,10
        X1MSK0(ISET)= 0.0
        X2MSK0(ISET)= 0.0
        Y1MSK0(ISET)= 0.0
        Y2MSK0(ISET)= 0.0
  500 CONTINUE
C
      MSKLV0= 0
C
C          MARKER CHARACTER:
C
      MARKC0= 232
C
C          FLAGS FOR INCBAR, INCHIS, MULBAR AND MULHIS.
C
      DO 600 ISET= 1,100
        INFLGS(ISET)= 1
  600 CONTINUE
C
C          ANNOTATION MODES:
C
      NOTATA= 10
      NOTATC= 62
C
C          PIECHART FIRST SECTOR ANGLE:
C
      ANGPIE= 0.0
C
C          PIECHART LABELLING METHOD:
C
      MPIELB= 1
C
C          INITIAL PLOTTING POSITION:
C
      XPLOT0= X1MAP0
      YPLOT0= Y1MAP0
C
C          SURFACE ELEVATION ANGLE:
C
      TLTANG= 0.61548
C
C          SURFACE AXIS ANNOTATION PARAMETERS:
C
      INDAXE= 0
      XAXORG= 0.0
      YAXORG= 0.0
      XAXDEL= 0.0
      YAXDEL= 0.0
C
C          SURFACE AZIMUTH ANGLE:
C
      AZIANG= 0.785398
C
C          SURFACE BASE PARAMETERS:
C
      IUNDRS= 1
      INDBAS= 0
      BASEHT= 0.0
C
C          SURFACE COLOUR NUMBERS:
C
      LINCUP= 0
      LINCLW= 2
      LINCBS= 0
C
C          SURFACE CONTOUR FLAG:
C      
      JCONTR= 1
C
C          SURFACE DIRECTION INDICATOR:
C
      ISURIN= 1
C
C          HUE, NUMBER OF COLOURS AND
C          START COLOUR FOR SHADED SURFACES:      
C
      HUESHD= 0.666667
      JKOLS= 7
      KOLSTA= 9
C
C          LIGHT SOURCE DIRECTION FOR SHADED SURFACES:
C     
      ALIGHT= -0.2
      BLIGHT= 0.4
      CLIGHT= -0.9
C
C          REFLECTIVITY COEFFICIENTS FOR SHADED SURFACES:
C      
      AMBINT= 0.2
      DIFFUS= 0.8
      SPECT= 0.4
C
C          SURFACE HEIGHT LIMITS AND X SCALE FACTOR:
C
      SHTMIN= 0.0
      SHTMAX= 0.0
      XPTCH= 1.0
C
C          SUFFIX/SUPERFIX LEVEL:
C
      MAGLVL= 0
C
C          TRACE LEVEL:
C
      IPRINT= 0
C
C          TRANSFORMATION VALUES:
C
      SCALX0= 1.0
      SCALY0= 1.0
      ROTAT0= 0.0
      RPICX0= 0.0
      RPICY0= 0.0
      RDEVX0= 0.0
      RDEVY0= 0.0
      VRPICX= X1MAP0
      VRPICY= Y1MAP0
      VRDEVX= X1MAP0
      VRDEVY= Y1MAP0
      SHIFT0= .FALSE.
      MTRAN0= 1
      KLIPM0= 0
C
C          WINDOW VALUES:
C
      X1WND0= 0.0
      X2WND0= 1.0
      Y1WND0= 0.0
      Y2WND0= 1.0
C
C          THE FOLLOWING ARE DEVICE-HANDLER COMMON BLOCKS:
C          ----------------------------------------------
C
C          OUTPUT-BUFFER STATE VARIABLES:
C
      IXFINI= -1
      IYFINI= -1
      LENFLB= 0
      KBUFR1= 0
      LIMSYS= 200
      ISYSTP= 0
      LENTHB= 3200
C
      DO 700 ICLEAR= 1,16
        IAREAP(ICLEAR)= 0
        ISTRTA(ICLEAR)= 0
        KAREAS(ICLEAR)= 0
        NAREAS(ICLEAR)= 0
  700 CONTINUE
C
      DO 800 ICLEAR= 1,32
        INEXTA(ICLEAR)= 0
  800 CONTINUE
C
      FULL= .FALSE.
C
C          CHARACTER VALUES:
C
      STANG1= 0.0
      CRANG1= 0.0
      STANGU= 0.0
      CRANGU= 0.0
      IUNDL1= 0
      ITAL1= 0
      SINCHR= 0.0
      COSCHR= 1.0
      SINSTR= 0.0
      COSSTR= 1.0
      KSTRT= 1
      NDEFS= 0
      KPOSN(1)= 0
      MAGN1= 10
      OBLAT1= 1.0
      KFNTCH= -1
      KFONT1= 1
C
C          DISPLAY I/O CHANNELS:
C
      IF (.NOT.DONE) KDISPI= -1
      IF (.NOT.DONE) KDISPO= -1
C
      ADDSP= 8.571429E-3
      ADDLN= 1.428571E-2
      ADDSPX= ADDSP
      ADDLNX= 0.0
      ADDSPY= 0.0
      ADDLNY= -ADDLN
      TYPMOD= .FALSE.
      XCHAR= 0.0
      YCHAR= 0.0
C
C          CURVE POINTER (OWN VARIABLE):
C
      ICVPTR= 3
C
C          CHARACTER WINDOW/MASK MODES:
C
      KWIND1= 0
      KMASK1= 0
C
C          DEVICE STATE:
C
      OPEN= .FALSE.
      KCHAN1(1)= 0
      KCHAN1(2)= 0
      KCHAN1(3)= 0
      KCHAN1(4)= 0
      KCHAN1(5)= 0
      IRESL1= 1
C
C          FILL AREA BUFFER SIZE (OWN VARIABLE):
C
      ISAVSZ= 1000
C
C          FILL-AREA BOUNDARY MARKER (OWN VARIABLE):
C
      BOUND= .FALSE.
C
C          CURRENT FUNCTION CODE/DATA LENGTH (OWN VARIABLES):
C
      NUMFUN= 0
      LENARG= 0
C
C          CROSS-HATCHING VALUES:
C
      IFLTY1= 0
      IFLRP1= 0
      IHATN1= 65
C
      DO 900 ISET= 1,255
        HTANG1(ISET,1)= 0.785398
        HTANG1(ISET,2)= -0.785398
        IHCOL1(ISET,1)= 0
        IHCOL1(ISET,2)= 0
        IHMKA1(ISET,1)= 0
        IHMKA1(ISET,2)= 0
        IHMSA1(ISET,1)= 0
        IHMSA1(ISET,2)= 0
        IHMKB1(ISET,1)= 0
        IHMKB1(ISET,2)= 0
        IHMSB1(ISET,1)= 0
        IHMSB1(ISET,2)= 0
        ISHFT1(ISET,1)= 0
        ISHFT1(ISET,2)= 0
        IPHAS1(ISET,1)= 0
        IPHAS1(ISET,2)= 0
        IPITH1(ISET,1)= 10
        IPITH1(ISET,2)= 10
        IPSFT1(ISET,1)= 0
        IPSFT1(ISET,2)= 0
        IHAT1(ISET)= 3
  900 CONTINUE
C
      DO 1000 ISET= 1,24
        HTANG1(ISET,1)= HTANGA(ISET,1)
        HTANG1(ISET,2)= HTANGA(ISET,2)
        IPITH1(ISET,1)= IPITHA(ISET,1)
        IPITH1(ISET,2)= IPITHA(ISET,2)
        IHAT1(ISET)= IHATA(ISET)
 1000 CONTINUE
C
      DO 1100 ISET= 33,56
        HTANG1(ISET,1)= HTANGB(ISET-32,1)
        HTANG1(ISET,2)= HTANGB(ISET-32,2)
        IHMKA1(ISET,1)= IHMKAB(ISET-32,1)
        IHMKA1(ISET,2)= IHMKAB(ISET-32,2)
        IHMSA1(ISET,1)= IHMSAB(ISET-32,1)
        IHMSA1(ISET,2)= IHMSAB(ISET-32,2)
        IHMKB1(ISET,1)= IHMKBB(ISET-32,1)
        IHMKB1(ISET,2)= IHMKBB(ISET-32,2)
        IHMSB1(ISET,1)= IHMSBB(ISET-32,1)
        IHMSB1(ISET,2)= IHMSBB(ISET-32,2)
        IPHAS1(ISET,1)= IPHASB(ISET-32,1)
        IPHAS1(ISET,2)= IPHASB(ISET-32,2)
        IPITH1(ISET,1)= IPITHB(ISET-32,1)
        IPITH1(ISET,2)= IPITHB(ISET-32,2)
        IPSFT1(ISET,1)= IPSFTB(ISET-32,1)
        IPSFT1(ISET,2)= IPSFTB(ISET-32,2)
 1100 CONTINUE
C
C          CHARACTER/LINE HARDWARE MODE:
C
      KHRDW1= .FALSE.
      LHRDW1= .FALSE.
C
C          SAVED LINE HARDWARE MODE (OWN VARIABLE):
C
      LHDEF= 1
C
C          DEFAULT COLOUR DEFINITIONS:
C
      KOLBA1= 0
C
      DO 1200 NCOLOR= 1,255
        REDCO1(NCOLOR)= 0.0
        GRNCO1(NCOLOR)= 0.0
        BLUCO1(NCOLOR)= 0.0
        NCFLG1(NCOLOR)= 0
 1200 CONTINUE
C
      REDCO1(2)= 1.0
      REDCO1(5)= 1.0
      REDCO1(7)= 1.0
      REDCO1(8)= 1.0
      GRNCO1(3)= 1.0
      GRNCO1(5)= 1.0
      GRNCO1(6)= 1.0
      GRNCO1(8)= 1.0
      BLUCO1(4)= 1.0
      BLUCO1(5)= 1.0
      BLUCO1(6)= 1.0
      BLUCO1(7)= 1.0
      NCOLS1= 8
      NCFLG1(1)= 1
      NCFLG1(2)= 1
      NCFLG1(3)= 1
      NCFLG1(4)= 1
      NCFLG1(5)= 1
      NCFLG1(6)= 1
      NCFLG1(7)= 1
      NCFLG1(8)= 1
C
C          LANDSCAPE FLAG
C
      LNDSCP= 0
C
C          LINE ATTRIBUTES:
C
      KOLIN1= 0
      ITHIK1= 1
      PATREM= 0.0
      MARKA1= 0
      MISSA1= 0
      MARKB1= 0
      MISSB1= 0
C
C          MAP VALUES:
C
      X1MAP1= CORNRL
      X2MAP1= CORNRR
      Y1MAP1= CORNRL
      Y2MAP1= CORNRR
      ORIMX1= X1MAP1
      ORIMY1= Y1MAP1
      SCAMX1= 0.85
      SCAMY1= 0.85
      MAPNO1= 1
C
C          MASK LEVEL:
C
      MSKLV1= 0
C
C          MARKER CHARACTER:
C
      MARKC1= 232
C
C          DEVICE PICTURE COUNT:
C
      NDPICS= 1
C
C          INITIAL PLOTTING POSITION (AFTER/BEFORE TRANSFORMATION):
C
      XPLOTA= 0.0
      YPLOTA= 0.0
      XPLOTB= 0.0
      YPLOTB= 0.0
      PSPP= .FALSE.
      XPLOT1= CORNRL
      YPLOT1= CORNRL
C
C          TRANSFORMATION COEFFICIENTS:
C
      XCBX= 1.0
      XCBY= 0.0
      YCBX= 0.0
      YCBY= 1.0
      RPICXB= 0.0
      RPICYB= 0.0
      RDEVXB= 0.0
      RDEVYB= 0.0
      XCCX= 1.0
      XCCY= 0.0
      YCCX= 0.0
      YCCY= 1.0
      RPICXC= 0.0
      RPICYC= 0.0
      RDEVXC= 0.0
      RDEVYC= 0.0
      CURTRA= .TRUE.
      XRVX= 1.0
      XRVY= 0.0
      YRVX= 0.0
      YRVY= 1.0
      RPICXR= 0.0
      RPICYR= 0.0
      RDEVXR= 0.0
      RDEVYR= 0.0
      SCALXC= 1.0
      SCALYC= 1.0
      ROTATC= 0.0
      SCALXS= 1.0
      SCALYS= 1.0
      ROTATS= 0.0
      RDEVXS= 0.0
      RDEVYS= 0.0
      SHIFT1= .FALSE.
      MTRAN1= 1
      KLIPM1= 0
      WINLIN= .FALSE.
      WNDOIN= .TRUE.
      MASKIN= .TRUE.
      INDLVL= 0
C
C          WINDOW VALUES:
C
      X1WND1= 0.1
      X2WND1= 0.95
      Y1WND1= 0.1
      Y2WND1= 0.95
C
C          THE FOLLOWING ARE GRIDFILE-HANDLER COMMON BLOCKS:
C          ------------------------------------------------
C
      IBLOKL= 512
      FIRST= .TRUE.
      IFILCO= 1
      IDGRID= 555819264
      LNFOFI= 0
      LNFOPI= 0
      LNFOFO= 0
      LNFOPO= 0
      READY(1)= .FALSE.
      READY(2)= .FALSE.
      LASTPN= 0
      KFILE= 1
C
      DO 1300 ISET= 1,32
        NAMEFO(ISET)= NAMDEF(ISET)
 1300 CONTINUE
C
      LNFILN= LENDEF
      LNPICN=  0
      LPIHED= 6
      NGPICS= 1
      LIMPIC= 20
      SCRTCH= .FALSE.
C
C          THE FOLLOWING ARE GLOBAL COMMON BLOCKS:
C          --------------------------------------
C
      PI= 3.141593
      INTRAC= .FALSE.
      ERRON= .TRUE.
      NUMERR= 0
      KMODE= 3
      GFOPEN= .TRUE.
      PPOPEN= .TRUE.
      NEWPIC= .TRUE.
      LVLPIC= 0
      IF (.NOT.DONE) K1ERR= 0
      IF (.NOT.DONE) K2ERR= 0
C
      LASCOD= 0
      INDXVB= 0
C
C          THE DEVICE-DEPENDENT COMMON BLOCKS ARE INITIALISED.
C
      CALL G1INIT(2)
      DONE= .TRUE.
C
      RETURN
      END
